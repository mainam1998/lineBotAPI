# ЁЯЪА р╕Др╕╣р╣Ир╕бр╕╖р╕нр╕Бр╕▓р╕гр╕Хр╕▒р╣Йр╕Зр╕Др╣Ир╕▓ LINE Bot File Upload System

## ЁЯУЛ р╕Вр╣Йр╕нр╕Бр╕│р╕лр╕Щр╕Фр╣Ар╕Ър╕╖р╣Йр╕нр╕Зр╕Хр╣Йр╕Щ

1. **р╕Ър╕▒р╕Нр╕Кр╕╡ LINE Developers** - [р╕кр╕бр╕▒р╕Др╕гр╕Чр╕╡р╣Ир╕Щр╕╡р╣И](https://developers.line.biz/)
2. **р╕Ър╕▒р╕Нр╕Кр╕╡ Google Cloud Platform** - [р╕кр╕бр╕▒р╕Др╕гр╕Чр╕╡р╣Ир╕Щр╕╡р╣И](https://cloud.google.com/)
3. **р╕Ър╕▒р╕Нр╕Кр╕╡ Vercel** - [р╕кр╕бр╕▒р╕Др╕гр╕Чр╕╡р╣Ир╕Щр╕╡р╣И](https://vercel.com/)
4. **Node.js 18+** - [р╕Фр╕▓р╕зр╕Щр╣Мр╣Вр╕лр╕ер╕Фр╕Чр╕╡р╣Ир╕Щр╕╡р╣И](https://nodejs.org/)

## ЁЯФз р╕Бр╕▓р╕гр╕Хр╕▒р╣Йр╕Зр╕Др╣Ир╕▓ LINE Bot

### 1. р╕кр╕гр╣Йр╕▓р╕З LINE Bot Channel

1. р╣Ар╕Вр╣Йр╕▓р╣Др╕Ыр╕Чр╕╡р╣И [LINE Developers Console](https://developers.line.biz/)
2. р╕кр╕гр╣Йр╕▓р╕З Provider р╣Гр╕лр╕бр╣И (р╕лр╕▓р╕Бр╕вр╕▒р╕Зр╣Др╕бр╣Ир╕бр╕╡)
3. р╕кр╕гр╣Йр╕▓р╕З Channel р╣Гр╕лр╕бр╣Ир╕Ыр╕гр╕░р╣Ар╕ар╕Ч "Messaging API"
4. р╕Бр╕гр╕нр╕Бр╕Вр╣Йр╕нр╕бр╕╣р╕ер╕Юр╕╖р╣Йр╕Щр╕Рр╕▓р╕Щ:
   - **Channel name**: р╕Кр╕╖р╣Ир╕нр╕Ър╕нр╕Чр╕Вр╕нр╕Зр╕Др╕╕р╕У
   - **Channel description**: р╕Др╕│р╕нр╕Шр╕┤р╕Ър╕▓р╕вр╕Ър╕нр╕Ч
   - **Category**: р╣Ар╕ер╕╖р╕нр╕Бр╕лр╕бр╕зр╕Фр╕лр╕бр╕╣р╣Ир╕Чр╕╡р╣Ир╣Ар╕лр╕бр╕▓р╕░р╕кр╕б
   - **Subcategory**: р╣Ар╕ер╕╖р╕нр╕Бр╕лр╕бр╕зр╕Фр╕лр╕бр╕╣р╣Ир╕вр╣Ир╕нр╕в

### 2. р╕Фр╕╢р╕Зр╕Вр╣Йр╕нр╕бр╕╣р╕е Channel Access Token р╣Бр╕ер╕░ Channel Secret

1. р╣Др╕Ыр╕Чр╕╡р╣Ир╣Бр╕Чр╣Зр╕Ъ **"Basic settings"**
   - р╕Др╕▒р╕Фр╕ер╕нр╕Б **Channel secret**
2. р╣Др╕Ыр╕Чр╕╡р╣Ир╣Бр╕Чр╣Зр╕Ъ **"Messaging API"**
   - р╕Др╕▒р╕Фр╕ер╕нр╕Б **Channel access token** (р╕лр╕▓р╕Бр╕вр╕▒р╕Зр╣Др╕бр╣Ир╕бр╕╡р╣Гр╕лр╣Йр╕Бр╕Ф Issue)

## тШБя╕П р╕Бр╕▓р╕гр╕Хр╕▒р╣Йр╕Зр╕Др╣Ир╕▓ Google Drive API

### 1. р╕кр╕гр╣Йр╕▓р╕З Google Cloud Project

1. р╣Ар╕Вр╣Йр╕▓р╣Др╕Ыр╕Чр╕╡р╣И [Google Cloud Console](https://console.cloud.google.com/)
2. р╕кр╕гр╣Йр╕▓р╕З Project р╣Гр╕лр╕бр╣Ир╕лр╕гр╕╖р╕нр╣Ар╕ер╕╖р╕нр╕Б Project р╕Чр╕╡р╣Ир╕бр╕╡р╕нр╕вр╕╣р╣И
3. р╣Ар╕Ыр╕┤р╕Фр╣Гр╕Кр╣Йр╕Зр╕▓р╕Щ Google Drive API:
   - р╣Др╕Ыр╕Чр╕╡р╣И **APIs & Services > Library**
   - р╕Др╣Йр╕Щр╕лр╕▓ "Google Drive API"
   - р╕Др╕ер╕┤р╕Б **Enable**

### 2. р╕кр╕гр╣Йр╕▓р╕З Service Account

1. р╣Др╕Ыр╕Чр╕╡р╣И **APIs & Services > Credentials**
2. р╕Др╕ер╕┤р╕Б **Create Credentials > Service Account**
3. р╕Бр╕гр╕нр╕Бр╕Вр╣Йр╕нр╕бр╕╣р╕е:
   - **Service account name**: р╕Кр╕╖р╣Ир╕н service account
   - **Service account ID**: р╕Ир╕░р╕Цр╕╣р╕Бр╕кр╕гр╣Йр╕▓р╕Зр╕нр╕▒р╕Хр╣Вр╕Щр╕бр╕▒р╕Хр╕┤
   - **Description**: р╕Др╕│р╕нр╕Шр╕┤р╕Ър╕▓р╕в (р╣Др╕бр╣Ир╕Ър╕▒р╕Зр╕Др╕▒р╕Ъ)
4. р╕Др╕ер╕┤р╕Б **Create and Continue**
5. р╕Вр╣Йр╕▓р╕б **Grant this service account access to project** (р╣Др╕бр╣Ир╕Ир╕│р╣Ар╕Ыр╣Зр╕Щ)
6. р╕Др╕ер╕┤р╕Б **Done**

### 3. р╕кр╕гр╣Йр╕▓р╕З Private Key

1. р╕Др╕ер╕┤р╕Бр╕Чр╕╡р╣И Service Account р╕Чр╕╡р╣Ир╣Ар╕Юр╕┤р╣Ир╕Зр╕кр╕гр╣Йр╕▓р╕З
2. р╣Др╕Ыр╕Чр╕╡р╣Ир╣Бр╕Чр╣Зр╕Ъ **Keys**
3. р╕Др╕ер╕┤р╕Б **Add Key > Create new key**
4. р╣Ар╕ер╕╖р╕нр╕Б **JSON** format
5. р╕Др╕ер╕┤р╕Б **Create** - р╣Др╕Яр╕ер╣М JSON р╕Ир╕░р╕Цр╕╣р╕Бр╕Фр╕▓р╕зр╕Щр╣Мр╣Вр╕лр╕ер╕Ф

### 4. р╕кр╕гр╣Йр╕▓р╕Зр╣Вр╕Яр╕ер╣Ар╕Фр╕нр╕гр╣Мр╣Гр╕Щ Google Drive

1. р╣Ар╕Вр╣Йр╕▓р╣Др╕Ыр╕Чр╕╡р╣И [Google Drive](https://drive.google.com/)
2. р╕кр╕гр╣Йр╕▓р╕Зр╣Вр╕Яр╕ер╣Ар╕Фр╕нр╕гр╣Мр╣Гр╕лр╕бр╣Ир╕кр╕│р╕лр╕гр╕▒р╕Ър╣Ар╕Бр╣Зр╕Ър╣Др╕Яр╕ер╣Мр╕Чр╕╡р╣Ир╕нр╕▒р╕Юр╣Вр╕лр╕ер╕Ф
3. р╕Др╕ер╕┤р╕Бр╕Вр╕зр╕▓р╕Чр╕╡р╣Ир╣Вр╕Яр╕ер╣Ар╕Фр╕нр╕гр╣М > **Share**
4. р╣Ар╕Юр╕┤р╣Ир╕б email р╕Вр╕нр╕З Service Account (р╕Ир╕▓р╕Бр╣Др╕Яр╕ер╣М JSON) р╣Бр╕ер╕░р╣Гр╕лр╣Йр╕кр╕┤р╕Чр╕Шр╕┤р╣М **Editor**
5. р╕Др╕▒р╕Фр╕ер╕нр╕Б **Folder ID** р╕Ир╕▓р╕Б URL (р╕кр╣Ир╕зр╕Щр╕лр╕ер╕▒р╕З `/folders/`)

## ЁЯФР р╕Бр╕▓р╕гр╕Хр╕▒р╣Йр╕Зр╕Др╣Ир╕▓ Environment Variables

### 1. р╕кр╕гр╣Йр╕▓р╕Зр╣Др╕Яр╕ер╣М .env.local

р╕кр╕гр╣Йр╕▓р╕Зр╣Др╕Яр╕ер╣М `.env.local` р╣Гр╕Щр╣Вр╕Яр╕ер╣Ар╕Фр╕нр╕гр╣М root р╕Вр╕нр╕Зр╣Вр╕Ыр╕гр╣Ар╕Ир╣Зр╕Д:

```env
# LINE Bot Configuration
LINE_CHANNEL_ACCESS_TOKEN=your_channel_access_token_here
LINE_CHANNEL_SECRET=your_channel_secret_here

# Google Drive Configuration
GOOGLE_SERVICE_ACCOUNT_EMAIL=your-service-account@your-project.iam.gserviceaccount.com
GOOGLE_PRIVATE_KEY="-----BEGIN PRIVATE KEY-----\nYour_Private_Key_Here\n-----END PRIVATE KEY-----"
GOOGLE_DRIVE_FOLDER_ID=your_folder_id_here

# Admin Configuration
ADMIN_KEY=your_admin_password_here

# Environment
NODE_ENV=development
```

### 2. р╕Бр╕▓р╕гр╕Фр╕╢р╕Зр╕Вр╣Йр╕нр╕бр╕╣р╕ер╕Ир╕▓р╕Бр╣Др╕Яр╕ер╣М JSON

р╕Ир╕▓р╕Бр╣Др╕Яр╕ер╣М JSON р╕Чр╕╡р╣Ир╕Фр╕▓р╕зр╕Щр╣Мр╣Вр╕лр╕ер╕Фр╕бр╕▓:

```json
{
  "type": "service_account",
  "project_id": "your-project-id",
  "private_key_id": "key-id",
  "private_key": "-----BEGIN PRIVATE KEY-----\n...\n-----END PRIVATE KEY-----\n",
  "client_email": "your-service-account@your-project.iam.gserviceaccount.com",
  "client_id": "client-id",
  "auth_uri": "https://accounts.google.com/o/oauth2/auth",
  "token_uri": "https://oauth2.googleapis.com/token",
  "auth_provider_x509_cert_url": "https://www.googleapis.com/oauth2/v1/certs",
  "client_x509_cert_url": "https://www.googleapis.com/robot/v1/metadata/x509/..."
}
```

р╣Гр╕Кр╣Йр╕Вр╣Йр╕нр╕бр╕╣р╕ер╕Фр╕▒р╕Зр╕Щр╕╡р╣Й:
- `GOOGLE_SERVICE_ACCOUNT_EMAIL` = `client_email`
- `GOOGLE_PRIVATE_KEY` = `private_key` (р╕гр╕зр╕бр╕Чр╕▒р╣Йр╕З `\n`)

## ЁЯЪА р╕Бр╕▓р╕г Deploy р╕Ър╕Щ Vercel

### 1. р╣Ар╕Кр╕╖р╣Ир╕нр╕бр╕Хр╣Ир╕н GitHub Repository

1. Push р╣Вр╕Др╣Йр╕Фр╕Вр╕╢р╣Йр╕Щ GitHub
2. р╣Ар╕Вр╣Йр╕▓р╣Др╕Ыр╕Чр╕╡р╣И [Vercel Dashboard](https://vercel.com/dashboard)
3. р╕Др╕ер╕┤р╕Б **New Project**
4. р╣Ар╕ер╕╖р╕нр╕Б Repository р╕Вр╕нр╕Зр╕Др╕╕р╕У
5. р╕Др╕ер╕┤р╕Б **Import**

### 2. р╕Хр╕▒р╣Йр╕Зр╕Др╣Ир╕▓ Environment Variables р╕Ър╕Щ Vercel

1. р╣Др╕Ыр╕Чр╕╡р╣И **Settings > Environment Variables**
2. р╣Ар╕Юр╕┤р╣Ир╕б Environment Variables р╕Чр╕▒р╣Йр╕Зр╕лр╕бр╕Фр╕Ир╕▓р╕Бр╣Др╕Яр╕ер╣М `.env.local`
3. р╕Хр╕▒р╣Йр╕Зр╕Др╣Ир╕▓р╣Гр╕лр╣Йр╣Гр╕Кр╣Йр╣Др╕Фр╣Йр╕Бр╕▒р╕Ъ **Production**, **Preview**, р╣Бр╕ер╕░ **Development**

### 3. Deploy

1. р╕Др╕ер╕┤р╕Б **Deploy**
2. р╕гр╕нр╣Гр╕лр╣Й deployment р╣Ар╕кр╕гр╣Зр╕Ир╕кр╕┤р╣Йр╕Щ
3. р╕Др╕▒р╕Фр╕ер╕нр╕Б URL р╕Чр╕╡р╣Ир╣Др╕Фр╣Й (р╣Ар╕Кр╣Ир╕Щ `https://your-app.vercel.app`)

## ЁЯФЧ р╕Бр╕▓р╕гр╕Хр╕▒р╣Йр╕Зр╕Др╣Ир╕▓ Webhook

### 1. р╕Хр╕▒р╣Йр╕Зр╕Др╣Ир╕▓ Webhook URL р╣Гр╕Щ LINE

1. р╕Бр╕ер╕▒р╕Ър╣Др╕Ыр╕Чр╕╡р╣И LINE Developers Console
2. р╣Др╕Ыр╕Чр╕╡р╣Ир╣Бр╕Чр╣Зр╕Ъ **Messaging API**
3. р╣Гр╕Щр╕кр╣Ир╕зр╕Щ **Webhook settings**:
   - **Webhook URL**: `https://your-app.vercel.app/api/callback`
   - р╣Ар╕Ыр╕┤р╕Ф **Use webhook**: ON
   - р╣Ар╕Ыр╕┤р╕Ф **Verify webhook**: ON (р╕Чр╕Фр╕кр╕нр╕Ър╕Бр╕▓р╕гр╣Ар╕Кр╕╖р╣Ир╕нр╕бр╕Хр╣Ир╕н)

### 2. р╕Ыр╕┤р╕Фр╕Бр╕▓р╕гр╕Хр╕нр╕Ър╕Бр╕ер╕▒р╕Ър╕нр╕▒р╕Хр╣Вр╕Щр╕бр╕▒р╕Хр╕┤

1. р╣Гр╕Щр╕кр╣Ир╕зр╕Щ **LINE Official Account features**:
   - **Auto-reply messages**: OFF
   - **Greeting messages**: OFF (р╕лр╕гр╕╖р╕нр╕Хр╕▒р╣Йр╕Зр╕Др╣Ир╕▓р╕Хр╕▓р╕бр╕Хр╣Йр╕нр╕Зр╕Бр╕▓р╕г)

## тЬЕ р╕Бр╕▓р╕гр╕Чр╕Фр╕кр╕нр╕Ъ

### 1. р╕Чр╕Фр╕кр╕нр╕Ъ Webhook

1. р╣Гр╕Щ LINE Developers Console р╣Др╕Ыр╕Чр╕╡р╣И **Messaging API**
2. р╕Др╕ер╕┤р╕Б **Verify** р╕Вр╣Йр╕▓р╕З Webhook URL
3. р╕Др╕зр╕гр╣Др╕Фр╣Й **Success**

### 2. р╕Чр╕Фр╕кр╕нр╕Ъ Bot

1. р╕кр╣Бр╕Бр╕Щ QR Code р╣Гр╕Щ LINE Developers Console
2. р╣Ар╕Юр╕┤р╣Ир╕бр╕Ър╕нр╕Чр╣Ар╕Ыр╣Зр╕Щр╣Ар╕Юр╕╖р╣Ир╕нр╕Щ
3. р╕кр╣Ир╕Зр╕Вр╣Йр╕нр╕Др╕зр╕▓р╕б `help` р╣Ар╕Юр╕╖р╣Ир╕нр╕Фр╕╣р╕Др╕│р╕кр╕▒р╣Ир╕Зр╕Чр╕╡р╣Ир╣Гр╕Кр╣Йр╣Др╕Фр╣Й
4. р╕Чр╕Фр╕кр╕нр╕Ър╕нр╕▒р╕Юр╣Вр╕лр╕ер╕Фр╣Др╕Яр╕ер╣М

## ЁЯФз р╕Бр╕▓р╕гр╣Бр╕Бр╣Йр╣Др╕Вр╕Ыр╕▒р╕Нр╕лр╕▓

### р╕Ыр╕▒р╕Нр╕лр╕▓р╕Чр╕╡р╣Ир╕Юр╕Ър╕Ър╣Ир╕нр╕в

1. **Webhook р╣Др╕бр╣Ир╕Чр╕│р╕Зр╕▓р╕Щ**
   - р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ъ URL р╣Гр╕лр╣Йр╕Цр╕╣р╕Бр╕Хр╣Йр╕нр╕З
   - р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ъ Environment Variables
   - р╕Фр╕╣ Logs р╣Гр╕Щ Vercel

2. **Google Drive р╣Др╕бр╣Ир╕кр╕▓р╕бр╕▓р╕гр╕Цр╕нр╕▒р╕Юр╣Вр╕лр╕ер╕Фр╣Др╕Фр╣Й**
   - р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ъ Service Account Email р╣Гр╕Щ Google Drive folder
   - р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ъ Private Key format
   - р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ъ Folder ID

3. **р╣Др╕Яр╕ер╣Мр╕Вр╕Щр╕▓р╕Фр╣Гр╕лр╕Нр╣Ир╕нр╕▒р╕Юр╣Вр╕лр╕ер╕Фр╣Др╕бр╣Ир╣Др╕Фр╣Й**
   - Vercel Free Plan р╕Ир╕│р╕Бр╕▒р╕Фр╕Чр╕╡р╣И 50MB
   - р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ъ timeout settings

### р╕Бр╕▓р╕гр╕Фр╕╣ Logs

1. **Vercel Logs**: р╣Др╕Ыр╕Чр╕╡р╣И Vercel Dashboard > Functions > View Function Logs
2. **LINE Webhook Logs**: р╣Др╕Ыр╕Чр╕╡р╣И LINE Developers Console > Messaging API > Webhook

## ЁЯУЮ р╕Бр╕▓р╕гр╕кр╕Щр╕▒р╕Ър╕кр╕Щр╕╕р╕Щ

р╕лр╕▓р╕Бр╕Юр╕Ър╕Ыр╕▒р╕Нр╕лр╕▓:
1. р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ъ Environment Variables
2. р╕Фр╕╣ Logs р╣Гр╕Щ Vercel
3. р╕Чр╕Фр╕кр╕нр╕Ъ API endpoints р╕Фр╣Йр╕зр╕в `/api/performance`
4. р╣Гр╕Кр╣Йр╕Др╕│р╕кр╕▒р╣Ир╕З `performance` р╣Гр╕Щ LINE Bot

---

**р╕лр╕бр╕▓р╕вр╣Ар╕лр╕Хр╕╕**: р╕нр╕вр╣Ир╕▓р╕ер╕╖р╕б commit р╣Др╕Яр╕ер╣М `.env.local` р╕ер╕Зр╣Гр╕Щ `.gitignore` р╣Ар╕Юр╕╖р╣Ир╕нр╕Др╕зр╕▓р╕бр╕Ыр╕ер╕нр╕Фр╕ар╕▒р╕в!
